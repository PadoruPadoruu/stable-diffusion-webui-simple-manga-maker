const ColorUtils={hexToRgb:function(hex){const rgba=this.hexToRgba(hex);return{r:rgba.r,g:rgba.g,b:rgba.b};},hexToRgba:function(hex,alpha){hex=hex.replace('#','');if(hex.length===3){hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];}const r=parseInt(hex.substring(0,2),16);const g=parseInt(hex.substring(2,4),16);const b=parseInt(hex.substring(4,6),16);let a=1;if(hex.length===8){a=parseInt(hex.substring(6,8),16)/255;}else if(alpha!==undefined){a=alpha;}return{r,g,b,a};},rgbaToCss:function(rgba){return`rgba(${rgba.r},${rgba.g},${rgba.b},${rgba.a})`;},rgbaToHex:function(rgba,includeAlpha=false){const toHex=(value)=>{const hex=Math.round(value).toString(16);return hex.length===1?'0'+hex:hex;};let result='#'+toHex(rgba.r)+toHex(rgba.g)+toHex(rgba.b);if(includeAlpha&&rgba.a!==undefined){result+=toHex(rgba.a*255);}return result;},blend:function(color1,color2,ratio){return{r:Math.round(MathUtils.lerp(color1.r,color2.r,ratio)),g:Math.round(MathUtils.lerp(color1.g,color2.g,ratio)),b:Math.round(MathUtils.lerp(color1.b,color2.b,ratio)),a:MathUtils.lerp(color1.a,color2.a,ratio)};},clampRgba:function(rgba){return{r:MathUtils.clamp(rgba.r,0,255),g:MathUtils.clamp(rgba.g,0,255),b:MathUtils.clamp(rgba.b,0,255),a:MathUtils.clamp(rgba.a,0,1)};},luminance:function(rgba){return(0.2126*rgba.r+0.7152*rgba.g+0.0722*rgba.b)/255;},multiplyBlend:function(base,blend){return{r:Math.round((base.r*blend.r)/255),g:Math.round((base.g*blend.g)/255),b:Math.round((base.b*blend.b)/255),a:base.a*blend.a};},getPixel:function(imageData,x,y){const index=(y*imageData.width+x)*4;return{r:imageData.data[index],g:imageData.data[index+1],b:imageData.data[index+2],a:imageData.data[index+3]/255};},setPixel:function(imageData,x,y,rgba){if(x<0||y<0||x>=imageData.width||y>=imageData.height){return;}const index=(y*imageData.width+x)*4;imageData.data[index]=rgba.r;imageData.data[index+1]=rgba.g;imageData.data[index+2]=rgba.b;imageData.data[index+3]=Math.round(rgba.a*255);}};